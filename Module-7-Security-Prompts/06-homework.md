# Домашнее задание: Безопасность и защита промптов

## Общая информация

**Время выполнения:** 50 минут (30 минут основное задание + 20 минут дополнительное)

**Формат:** Индивидуальная работа с возможностью парного тестирования

**Доставка:** Markdown файлы в репозитории курса

---

## Задание 1: Создание защищенного промпта (30 минут)

### Цель

Создать максимально защищенный промпт для чатбота поддержки с применением всех изученных техник защиты.

### Требования

#### Функциональность чатбота:

1. **Обработка запросов клиентов:**
   - Ответы на вопросы о продуктах
   - Предоставление информации о ценах
   - Помощь с техническими проблемами

2. **Обработка жалоб:**
   - Выслушивание жалоб клиентов
   - Предоставление решений
   - Эскалация сложных случаев

3. **Предоставление контактной информации:**
   - Email службы поддержки
   - Телефон горячей линии
   - Часы работы

#### Требования безопасности:

1. **Защита от Direct Injection:**
   - Фильтрация подозрительных паттернов
   - Защита от игнорирования инструкций
   - Защита от переопределения роли

2. **Защита от Indirect Injection:**
   - Валидация внешних данных
   - Фильтрация контента из RAG
   - Проверка загруженных файлов

3. **Защита от Multi-turn Injection:**
   - Отслеживание контекста разговора
   - Обнаружение попыток изменения поведения
   - Защита от постепенных атак

4. **Защита конфиденциальной информации:**
   - Не раскрывать системные промпты
   - Не раскрывать API ключи
   - Не раскрывать внутреннюю логику

5. **Мониторинг:**
   - Логирование подозрительной активности
   - Алерты при обнаружении атак
   - Отслеживание изменений в поведении

### Структура доставки

Создайте файл `secure-prompt.md` со следующей структурой:

```markdown
# Защищенный промпт для чатбота поддержки

## Системный промпт

[Ваш защищенный промпт здесь]

## Примененные техники защиты

### 1. Input Sanitization
- Описание примененных техник
- Примеры фильтрации

### 2. Prompt Isolation
- Описание разделителей
- Структура изоляции

### 3. Role-Based Restrictions
- Определение роли
- Ограничения функциональности

### 4. Output Filtering
- Проверка ответов
- Фильтрация конфиденциальной информации

### 5. Monitoring
- Логирование
- Алерты

## Тест-кейсы

### Тест 1: Direct Injection
- Входные данные: [пример атаки]
- Ожидаемый результат: [как должен обработать]
- Фактический результат: [результат тестирования]

### Тест 2: Role Confusion
- Входные данные: [пример атаки]
- Ожидаемый результат: [как должен обработать]
- Фактический результат: [результат тестирования]

[Добавьте минимум 5 тест-кейсов]

## Найденные уязвимости

[Если нашли уязвимости, опишите их здесь]

## Рекомендации по улучшению

[Рекомендации для дальнейшего улучшения защиты]
```

### Критерии оценки

- ✅ Применены минимум 4 техники защиты
- ✅ Промпт функционален для чатбота поддержки
- ✅ Создано минимум 5 тест-кейсов
- ✅ Документированы примененные техники
- ✅ Проведено тестирование на уязвимости

---

## Задание 2: Этичное тестирование (20 минут)

### Цель

Провести этичное тестирование промптов одногруппников для выявления уязвимостей и обмена опытом.

### Правила

1. **Только с разрешения:**
   - Получите явное разрешение владельца промпта
   - Согласуйте границы тестирования
   - Уважайте ограничения

2. **Только в учебных целях:**
   - Не используйте найденные уязвимости во вред
   - Не распространяйте информацию о уязвимостях публично
   - Соблюдайте конфиденциальность

3. **Документирование:**
   - Задокументируйте все найденные уязвимости
   - Предоставьте отчет владельцу промпта
   - Включите рекомендации по улучшению

### Процесс тестирования

1. **Получение разрешения:**
   - Свяжитесь с одногруппником
   - Получите его промпт для тестирования
   - Согласуйте правила тестирования

2. **Проведение тестирования:**
   - Попробуйте различные техники атак:
     - Direct injection
     - Role confusion
     - Information extraction
     - Multi-turn injection
   - Задокументируйте все попытки

3. **Создание отчета:**
   - Опишите найденные уязвимости
   - Предоставьте примеры успешных атак
   - Включите рекомендации по улучшению

### Структура отчета

Создайте файл `security-test-report.md`:

```markdown
# Отчет о тестировании безопасности промпта

## Информация о тестировании

- Дата: [дата]
- Тестируемый промпт: [ссылка или описание]
- Владелец: [имя с разрешением]
- Тестировщик: [ваше имя]

## Проведенные тесты

### Тест 1: Direct Injection - Игнорирование инструкций
- Входные данные: [пример]
- Результат: [успешно/неуспешно]
- Описание: [что произошло]

### Тест 2: Role Confusion
- Входные данные: [пример]
- Результат: [успешно/неуспешно]
- Описание: [что произошло]

[Добавьте все проведенные тесты]

## Найденные уязвимости

### Уязвимость 1: [название]
- Описание: [что это за уязвимость]
- Серьезность: [низкая/средняя/высокая/критическая]
- Пример эксплуатации: [как можно использовать]
- Рекомендации: [как исправить]

[Добавьте все найденные уязвимости]

## Рекомендации по улучшению

1. [Рекомендация 1]
2. [Рекомендация 2]
3. [Рекомендация 3]

## Заключение

[Общие выводы и рекомендации]
```

### Критерии оценки

- ✅ Получено разрешение на тестирование
- ✅ Проведено минимум 5 различных тестов
- ✅ Задокументированы все найденные уязвимости
- ✅ Предоставлены рекомендации по улучшению
- ✅ Соблюдены этические принципы

---

## Дополнительное задание (опционально)

### Анализ реальных кейсов

Выберите один из реальных кейсов prompt injection и проведите анализ:

1. **Описание кейса:**
   - Что произошло?
   - Какие были последствия?
   - Как была обнаружена атака?

2. **Анализ уязвимости:**
   - Какой тип атаки был использован?
   - Почему атака была успешной?
   - Какие техники защиты отсутствовали?

3. **Рекомендации:**
   - Как можно было предотвратить атаку?
   - Какие техники защиты нужно было применить?
   - Какие уроки можно извлечь?

### Создание базы знаний

Создайте базу знаний по безопасности промптов:

1. **Коллекция техник атак:**
   - Описание различных техник
   - Примеры использования
   - Методы защиты

2. **Коллекция техник защиты:**
   - Описание техник
   - Примеры реализации
   - Best practices

3. **Кейсы и примеры:**
   - Реальные инциденты
   - Уроки из кейсов
   - Применение на практике

---

## Инструменты для выполнения

### Основные инструменты:

1. **ChatGPT / Claude:**
   - Для тестирования промптов
   - Для проверки защиты
   - Для экспериментов

2. **Gandalf Game:**
   - Для практики обхода защиты
   - Для изучения техник
   - https://gandalf.lakera.ai

3. **OWASP LLM Top 10:**
   - Для изучения best practices
   - Для понимания рисков
   - https://owasp.org/www-project-top-10-for-large-language-model-applications/

### Дополнительные ресурсы:

- Prompt Injection Fuzzer
- Security Checklists
- Research Papers

---

## Критерии оценки домашнего задания

### Задание 1: Защищенный промпт (60%)

- **Функциональность (20%):**
  - Промпт работает как чатбот поддержки
  - Обрабатывает основные запросы
  - Предоставляет нужную информацию

- **Безопасность (30%):**
  - Применены техники защиты
  - Защита от различных типов атак
  - Многоуровневая защита

- **Документация (10%):**
  - Описаны примененные техники
  - Созданы тест-кейсы
  - Документированы уязвимости

### Задание 2: Тестирование (40%)

- **Процесс тестирования (20%):**
  - Получено разрешение
  - Проведены различные тесты
  - Соблюдены этические принципы

- **Отчет (20%):**
  - Задокументированы уязвимости
  - Предоставлены рекомендации
  - Качество анализа

---

## Сроки выполнения

- **Основное задание:** До следующего занятия
- **Дополнительное задание:** По желанию

## Вопросы и поддержка

Если у вас возникли вопросы:

1. Проверьте материалы модуля
2. Обратитесь к одногруппникам
3. Задайте вопрос преподавателю

---

**Удачи в выполнении домашнего задания!**

*Помните: безопасность - это процесс, а не результат. Регулярное тестирование и обновление защиты критически важно.*

